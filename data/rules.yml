version: "3.1"

rules:
  - rule: Activate pizza order form after showing menu
    steps:
      - intent: menu
      - action: utter_menu
      - action: action_pizza_order_form
      - active_loop: action_pizza_order_form
      - active_loop: null
      - action: utter_summarize_order

#  - rule: Confirm pizza order after form submission
#    condition:
#      - active_loop: pizza_order_form
#    steps:
#      - action: pizza_order_form
#      - active_loop: null
#      - slot_was_set:
#          - requested_slot: null
#      - intent: confirm_order
#      - action: action_submit_order  # This action processes the final order
#######################################################################################
#  - rule: General pizza ordering process
#    steps:
#      - intent: menu
#      - action: utter_menu
#      - intent: pizza_type
#      - action: action_provide_toppings
#      - intent: topping_confirm
#      - action: action_customize_toppings
#      - action: utter_ask_size
#      - intent: size
#      - action: utter_ask_quantity
#      - intent: quantity
#      - action: utter_add_more_pizza
#      - intent: deny_add_more_pizza
#      - action: utter_summarize_order
#      - action: utter_finish_order
#      - action: utter_goodbye
#######################################################################################
  - rule: Handle order denial after form submission
    condition:
      - active_loop: action_pizza_order_form
    steps:
      - action: action_pizza_order_form
      - active_loop: null
      - slot_was_set:
          - requested_slot: null
      - intent: deny_order
      - action: action_handle_user_request  # This action handles order denial

#######################################################################################
  - rule: Greet user
    steps:
      - intent: greet
      - action: utter_greet

#  - rule: Show menu when asked
#    steps:
#      - intent: menu
#      - action: action_show_category_menu

  - rule: Goodbye
    steps:
      - intent: goodbye
      - action: utter_goodbye

#  - rule: Start pizza order
#    steps:
#      - intent: pizza_Category
#      - action: pizza_order_form
#      - active_loop: pizza_order_form

#  - rule: Order confirmation
#    condition:
#      # Condition that this rule is only applied when the pizza order form is filled
#      - active_loop: pizza_order_form
#    steps:
#      - action: pizza_order_form
#      - active_loop: null
#      - slot_was_set:
#          - requested_slot: null
#      - action: utter_confirm_order
  - rule: out-of-scope
    steps:
      - intent: out_of_scope
      - action: utter_out_of_scope

  - rule: Finish order
    steps:
      - intent: finish_order
      - action: utter_finish_order

  - rule: Deny order
    steps:
      - intent: deny_order
      - action: utter_deny_order
      - action: action_handle_user_request

#  - rule: Show menu when asked
#    steps:
#      - intent: menu
#      - action: utter_menu




#rules:
#- rule: User shows interest in the menu
#  steps:
#  - intent: menu
#  - action: utter_menu
#
#- rule: User chooses Vegetarian pizza
#  steps:
#  - intent: choose_pizza
#    entities:
#    - pizza_type: "Vegetarian"
#  - action: utter_vegetarian_menu
#
#- rule: User chooses Non-Vegetarian pizza
#  steps:
#  - intent: choose_pizza
#    entities:
#    - pizza_type: "Non-Vegetarian"
#  - action: utter_non_vegetarian_menu



#rules:
#- rule: Activate form
#  steps:
#  - intent: item_start_generic
#  - action: pizza_order_form
#  - active_loop: pizza_order_form
#
#
#- rule: submit form
#  condition:
#    - active_loop: pizza_order_form
#  steps:
#      - action: pizza_order_form      # run the form
#      - active_loop: null
#      - action: utter_item_change
#
#
#- rule: out-of-scope
#  steps:
#  - intent: out_of_scope
#  - action: utter_out_of_scope
#
#- rule: start
#  steps:
#    - intent: init_request
#    - action: utter_init_request
#
#- rule: menu
#  steps:
#    - intent: menu
#    - action: utter_ask_menu
#    - active_loop: pizza_order_form
#
#
#- rule: where are you?
#  steps:
#    - intent: request_restaurant_location
#    - action: action_get_restaurant_location
#    - action: utter_inform_restaurant_location
#    - action: utter_anything_else
